# Git セキュリティチェックリスト

コミット前に以下を確認してください：

## ✅ 機密情報チェック

- [ ] APIキーが直接コードに書かれていない
- [ ] パスワードやトークンが含まれていない
- [ ] データベースファイル（.db）が除外されている
- [ ] ログファイルが除外されている
- [ ] アップロードされたユーザーファイルが除外されている

## ✅ .gitignore確認

以下がすべて`.gitignore`に含まれていること：

- [x] `application-secret.properties` - APIキー保存ファイル
- [x] `*.db` - SQLiteデータベース
- [x] `node_modules/` - npm依存関係
- [x] `logs/` - ログファイル
- [x] `uploads/` - ユーザーアップロードファイル
- [x] `.env` - 環境変数ファイル

## ✅ コミット前の確認コマンド

```bash
# 変更されたファイルを確認
git status

# APIキーが含まれていないか確認
git diff | Select-String -Pattern "AIza|api.*key.*="

# 追跡されていないファイルを確認
git status --untracked-files

# .gitignoreが正しく動作しているか確認
git check-ignore application-secret.properties
# → "application-secret.properties" と表示されればOK
```

## 🔒 安全にコミットする手順

```bash
# ステージング
git add .

# 最終確認
git status

# コミット
git commit -m "コミットメッセージ"

# プッシュ
git push
```

## ⚠️ もしAPIキーをコミットしてしまったら

1. **すぐにAPIキーを無効化**
   - Gemini API: https://makersuite.google.com/app/apikey
   - Leonardo AI: https://leonardo.ai

2. **新しいAPIキーを発行**

3. **コミット履歴から削除**
   ```bash
   # 最新のコミットを取り消し
   git reset HEAD~1
   
   # または履歴を書き換え（高度）
   git filter-branch --force --index-filter \
     "git rm --cached --ignore-unmatch src/main/resources/application-secret.properties" \
     --prune-empty --tag-name-filter cat -- --all
   ```

4. **強制プッシュ（チームで作業している場合は要注意）**
   ```bash
   git push --force
   ```
