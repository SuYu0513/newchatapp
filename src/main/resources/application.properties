spring.application.name=chatapp

# Server Configuration
server.port=9090
server.address=0.0.0.0

# PWA/HTTPS設定
server.forward-headers-strategy=native

# Database Configuration - 環境変数で切り替え
# ローカル: SQLite (デフォルト)
# Render: PostgreSQL (DATABASE_URL環境変数で自動切り替え)
spring.datasource.url=${DATABASE_URL:jdbc:sqlite:./chatapp.db}
spring.datasource.driverClassName=${DB_DRIVER:org.sqlite.JDBC}
spring.datasource.username=${DB_USERNAME:}
spring.datasource.password=${DB_PASSWORD:}

# JPA Configuration
spring.jpa.database-platform=${DB_DIALECT:org.hibernate.community.dialect.SQLiteDialect}
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false

# JPAキャッシュを完全無効化（デバッグ用）
spring.jpa.properties.hibernate.cache.use_second_level_cache=false
spring.jpa.properties.hibernate.cache.use_query_cache=false
spring.jpa.properties.hibernate.generate_statistics=false

# SQL初期化設定を無効化（JavaコードでのInitializationを使用）
spring.sql.init.mode=never

# File Upload Configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=5MB

# Static Resources Configuration
spring.web.resources.static-locations=classpath:/static/

# Error Handling Configuration - より強固なセキュリティ
server.error.whitelabel.enabled=false
server.error.include-message=never
server.error.include-stacktrace=never
spring.web.resources.cache.period=0
spring.web.resources.cache.use-last-modified=false

# 開発時のキャッシュ無効化
spring.thymeleaf.cache=false

# PWA設定
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.http-only=true

# 循環参照を一時的に許可（開発時のみ）
spring.main.allow-circular-references=true

# ========================================
# セキュリティ設定（本番では環境変数で上書き）
# ========================================

# デバッグモード（本番ではfalseに設定: DEBUG_MODE=false）
app.debug.enabled=${DEBUG_MODE:true}

# H2コンソール（本番では無効: H2_CONSOLE_ENABLED=false）
spring.h2.console.enabled=${H2_CONSOLE_ENABLED:true}

# Remember-meキー（本番では必ずランダムな文字列を設定: REMEMBER_ME_KEY=xxxxxx）
app.security.remember-me-key=${REMEMBER_ME_KEY:dev-only-key-change-in-production}

# Logging Configuration
logging.level.root=INFO
logging.level.com.example.chatapp=DEBUG

# Additional config file (for API keys - not committed to Git)
spring.config.import=optional:classpath:application-secret.properties

# Gemini AI API
gemini.api.key=${GEMINI_API_KEY:}

# Leonardo AI API (Avatar Generation)
leonardo.api.key=${LEONARDO_API_KEY:}
