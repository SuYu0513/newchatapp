<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, interactive-widget=resizes-visual-viewport">
    <title>üè† „Éõ„Éº„É† - „ÉÅ„É£„ÉÉ„Éà„Ç¢„Éó„É™</title>
    
    <!-- PWAË®≠ÂÆö -->
    <link rel="manifest" href="/manifest.json?v=4">
    <meta name="theme-color" content="#667eea">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link th:href="@{/css/home.css(v=${@appVersion})}" rel="stylesheet">
</head>
<body>
    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
    <div class="home-container">
        <div class="home-content">
            <div class="welcome-section">
                <h1>üè† „Éõ„Éº„É†</h1>
                <p class="welcome-text" th:text="'„Çà„ÅÜ„Åì„Åù„ÄÅ' + ${username} + ' „Åï„Çì'">„Çà„ÅÜ„Åì„Åù</p>
            </div>
            
            <!-- ÊàêÂäü„É°„ÉÉ„Çª„Éº„Ç∏ -->
            <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
                <i class="fas fa-check-circle me-1"></i>
                <span th:text="${success}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            
            <!-- ÊäïÁ®ø„Éï„Ç©„Éº„É† -->
            <div class="post-form-card">
                <form th:action="@{/home/post}" method="post" class="post-form">
                    <textarea name="content" class="post-textarea" 
                              placeholder="‰ªä‰Ωï„Åó„Å¶„ÇãÔºü" 
                              maxlength="1000" 
                              required></textarea>
                    <div class="post-form-footer">
                        <span class="char-counter">0 / 1000</span>
                        <button type="submit" class="btn-post">
                            <i class="fas fa-paper-plane me-1"></i>ÊäïÁ®ø
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- ÊäïÁ®ø„É™„Çπ„Éà -->
            <div class="posts-container">
                <div th:if="${posts == null or posts.isEmpty()}" class="no-posts">
                    <i class="fas fa-inbox fa-3x mb-3 text-muted"></i>
                    <p class="text-muted">„Åæ„Å†ÊäïÁ®ø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                </div>
                
                <div th:each="post : ${posts}" class="post-card">
                    <div class="post-header">
                        <div class="post-user-info">
                            <img th:if="${post.user.profile != null and post.user.profile.avatar != null}" 
                                 th:src="@{'/uploads/avatars/' + post.user.profile.avatar}" 
                                 class="post-avatar" 
                                 alt="„Ç¢„Ç§„Ç≥„É≥">
                            <img th:if="${post.user.profile == null or post.user.profile.avatar == null}" 
                                 src="/images/default-avatar.png" 
                                 class="post-avatar" 
                                 alt="„Ç¢„Ç§„Ç≥„É≥">
                            <div class="post-user-details">
                                <span class="post-username" th:text="${post.user.username}">„É¶„Éº„Ç∂„ÉºÂêç</span>
                                <span class="post-time" th:text="${#temporals.format(post.createdAt, 'yyyyÂπ¥MMÊúàddÊó• HH:mm')}">ÊäïÁ®øÊó•ÊôÇ</span>
                            </div>
                        </div>
                    </div>
                    <div class="post-content">
                        <p th:text="${post.content}">ÊäïÁ®øÂÜÖÂÆπ</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- „Éï„ÉÉ„Çø„Éº„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
    <footer class="bottom-nav">
        <a href="/home" class="nav-item active">
            <i class="fas fa-home"></i>
            <span>„Éõ„Éº„É†</span>
        </a>
        <a href="/rooms" class="nav-item">
            <i class="fas fa-door-open"></i>
            <span>„É´„Éº„É†</span>
        </a>
        <button class="nav-item">
            <i class="fas fa-random"></i>
            <span>„Éû„ÉÉ„ÉÅ</span>
        </button>
        <button class="nav-item">
            <i class="fas fa-comments"></i>
            <span>„ÉÅ„É£„ÉÉ„Éà</span>
        </button>
        <button class="nav-item">
            <i class="fas fa-user"></i>
            <span>„Éû„Ç§„Éö„Éº„Ç∏</span>
        </button>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ÊñáÂ≠ó„Ç´„Ç¶„É≥„Çø„Éº
        const textarea = document.querySelector('.post-textarea');
        const counter = document.querySelector('.char-counter');
        
        if (textarea && counter) {
            textarea.addEventListener('input', function() {
                const length = this.value.length;
                counter.textContent = length + ' / 1000';
                
                if (length > 900) {
                    counter.style.color = '#dc3545';
                } else if (length > 800) {
                    counter.style.color = '#ffc107';
                } else {
                    counter.style.color = '#6c757d';
                }
            });
        }
    </script>
</body>
</html>
